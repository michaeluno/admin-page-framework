!function(){var r=AdminPageFrameworkScriptFormMediaUploader;getAdminPageFrameworkCustomMediaUploaderSelectObject=function(){return wp.media.view.MediaFrame.Select.extend({initialize:function(){wp.media.view.MediaFrame.prototype.initialize.apply(this,arguments),_.defaults(this.options,{multiple:!0,editing:!1,state:"insert",metadata:{}}),this.createSelection(),this.createStates(),this.bindHandlers(),this.createIframeStates()},createStates:function(){var e=this.options;this.states.add([new wp.media.controller.Library({id:"insert",title:"Insert Media",priority:20,toolbar:"main-insert",filterable:"image",library:wp.media.query(e.library),multiple:!!e.multiple&&"reset",editable:!0,allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0}),new wp.media.controller.Embed(e)]),wp.media.view.settings.post.featuredImageId&&this.states.add(new wp.media.controller.FeaturedImage)},bindHandlers:function(){this.on("router:create:browse",this.createRouter,this),this.on("router:render:browse",this.browseRouter,this),this.on("content:create:browse",this.browseContent,this),this.on("content:render:upload",this.uploadContent,this),this.on("toolbar:create:select",this.createSelectToolbar,this),this.on("menu:create:gallery",this.createMenu,this),this.on("toolbar:create:main-insert",this.createToolbar,this),this.on("toolbar:create:main-gallery",this.createToolbar,this),this.on("toolbar:create:featured-image",this.featuredImageToolbar,this),this.on("toolbar:create:main-embed",this.mainEmbedToolbar,this);_.each({menu:{default:"mainMenu"},content:{embed:"embedContent","edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar"}},function(e,i){_.each(e,function(e,t){this.on(i+":render:"+t,this[e],this)},this)},this)},mainMenu:function(e){e.set({"library-separator":new wp.media.View({className:"separator",priority:100})})},embedContent:function(){var e=new wp.media.view.Embed({controller:this,model:this.state()}).render();this.content.set(e),e.url.focus()},editSelectionContent:function(){var e=this.state(),t=e.get("selection"),e=new wp.media.view.AttachmentsBrowser({controller:this,collection:t,selection:t,model:e,sortable:!0,search:!1,dragInfo:!0,AttachmentView:wp.media.view.Attachment.EditSelection}).render();e.toolbar.set("backToLibrary",{text:r.messages.returnToLibrary,priority:-100,click:function(){this.controller.content.mode("browse")}}),this.content.set(e)},selectionStatusToolbar:function(e){var t=this.state().get("editable");e.set("selection",new wp.media.view.Selection({controller:this,collection:this.state().get("selection"),priority:-40,editable:t&&function(){this.controller.content.mode("edit-selection")}}).render())},mainInsertToolbar:function(e){var i=this;this.selectionStatusToolbar(e),e.set("insert",{style:"primary",priority:80,text:r.messages.select,requires:{selection:!0},click:function(){var e=i.state(),t=e.get("selection");i.close(),e.trigger("insert",t).reset()}})},featuredImageToolbar:function(e){this.createSelectToolbar(e,{text:l10n.setFeaturedImage,state:this.options.state||"upload"})},mainEmbedToolbar:function(e){this.state().set("library",!1),e.view=new wp.media.view.Toolbar.Embed({controller:this,text:r.messages.insert})}})}}(jQuery);