/*! Admin Page Framework - Media Field Type 0.0.1 */
var apfMain=AdminPageFrameworkScriptFormMain,apfMedia=AdminPageFrameworkMediaFieldType;function debugLog(...e){parseInt(apfMain.debugMode)&&console.log("APF Media Field Type:",...e)}apfMedia.hasMediaUploader=!!apfMedia.hasMediaUploader,debugLog("loaded:","0.0.19",apfMedia),function(r){var a;r(document).ready(function(){var t;function d(e,i){r("#"+e).val(i.url),r("#"+e+"_id").val(i.id),r("#"+e+"_caption").val(r("<div/>").text(i.caption).html()),r("#"+e+"_description").val(r("<div/>").text(i.description).html())}apfMedia.hasMediaUploader?a=function(e,i,a){var n,t=!1,e=r("#select_media_"+e);e.off("click"),e.on("click",function(e){var d=r(this).attr("id").substring(13);if(window.wpActiveEditor=null,e.preventDefault(),"object"!=typeof n)return oAdminPageFrameworkOriginalMediaUploaderSelectObject=wp.media.view.MediaFrame.Select,wp.media.view.MediaFrame.Select=a?getAdminPageFrameworkCustomMediaUploaderSelectObject():oAdminPageFrameworkOriginalMediaUploaderSelectObject,(n=wp.media({title:a?apfMedia.label.insertFromURL:apfMedia.label.uploadFile,button:{text:apfMedia.label.useThisFile},multiple:i,metadata:{}})).on("escape",function(){return!(t=!0)}),n.on("close",function(){var a,e=n.state();if(void 0!==e.props&&void 0!==e.props.attributes){var i,t={};for(i in e.props.attributes)t[i]=e.props.attributes[i]}void 0!==t?o(d,t):n.state().get("selection").each(function(e,i){e=e.hasOwnProperty("attributes")?e.attributes:{};if(0===i)return o(d,e),!0;i=void 0===a?r("#"+d).closest(".admin-page-framework-field"):a,i=(a=r(this).addAdminPageFrameworkRepeatableField(i.attr("id"))).find("input").attr("id");o(i,e)}),wp.media.view.MediaFrame.Select=oAdminPageFrameworkOriginalMediaUploaderSelectObject}),n.open(),!1;n.open()});var o=function(e,i,a){a=void 0===a?100:a,setTimeout(function(){t||d(e,i),t=!1},a)}}:(a=function(e,i,a){e=r("#select_media_"+e);e.off("click"),e.on("click",function(){var e=r(this).attr("id");window.sInputID=e.substring(13),window.original_send_to_editor=window.send_to_editor,window.send_to_editor=t;e=r(this).attr("data-enable_external_source");return tb_show(apfMedia.label.uploadFile,"media-upload.php?post_id=1&amp;enable_external_source="+e+"&amp;referrer="+apfMedia.referer+"&amp;button_label="+apfMedia.label.useThisFile+"&amp;type=image&amp;TB_iframe=true",!1),!1})},t=function(e,i){var a="<div>"+e+"</div>",t=r("a",a).attr("href"),e=r("a",a).attr("class"),a=e?e.replace(/(.*?)wp-image-/,""):"",e=window.sInputID;r("#"+e).val(t),r("#"+e+"_id").val(a),window.send_to_editor=window.original_send_to_editor,tb_remove()}),r(document).ready(function(){r("a.select_media.button").each(function(){a(r(this).data("input_id"),r(this).data("repeatable"),r(this).data("enable_external_source"))}),r("a.remove_media.button").on("click",function(){return d(r(this).data("input_id"),{}),!1}),r().registerAdminPageFrameworkCallbacks({repeated_field:function(e,i){e.find(".select_media.button, .remove_media.button").incrementAttributes(["id","data-input_id"],i.incremented_from,i.id);i=e.find(".media-field input");if(i.length<=0)return console.log("media field inputs not found"),!0;a(i.attr("id"),!0,e.find(".select_media").attr("data-enable_external_source")),console.log("cloned:",i.attr("id")),console.log("found:",r("#remove_media_"+i.attr("id")).length),r("#remove_media_"+i.attr("id")).on("click",function(){return console.log("clicked:",r(this).attr("id")),d(r(this).data("input_id"),{}),!1})}},apfMedia.fieldTypeSlugs)})})}(jQuery);