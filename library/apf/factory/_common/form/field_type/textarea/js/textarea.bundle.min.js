/*! Admin Page Framework - Textarea Field Type 0.0.3 */
!function(p){var e=AdminPageFrameworkScriptFormMain,i=AdminPageFrameworkFieldTypeTextArea;function s(...t){parseInt(e.debugMode)&&console.log("APF Textarea Field Type",...t)}p(document).ready(function(){var o,c,r;"undefined"!==i?(s("0.0.3",i),p("link#editor-buttons-css").appendTo("#wpwrap"),"undefined"!=typeof tinymce&&4<=tinymce.majorVersion&&void 0!==tinymce.editors&&tinymce.editors.length&&p('input[type="hidden"][data-tinymce-textarea]').each(function(){for(var t=p(this).attr("data-tinymce-textarea"),e=0;e<tinymce.editors.length;e++)t===tinymce.editors[e].id&&tinymce.get(e).on("change",function(){var t=p("#"+this.id),e=this.getContent();t.val(e),t.html(e)})}),o=function(t,e){return!(p.inArray(e,i.fieldTypeSlugs)<=-1)&&("object"==typeof tinyMCEPreInit||void 0)},c=function(t,e,i){var n,r,a=t;"object"==typeof tinyMCEPreInit&&(r=(n=p("#"+a)).val(),tinyMCE.execCommand("mceRemoveEditor",!1,a),delete tinyMCEPreInit.mceInit[a],delete tinyMCEPreInit.qtInit[a],n.val(r)),e=p.extend({},e,{selector:"#"+t,body_class:t,height:"100px",menubar:!1,setup:function(t){4<=tinymce.majorVersion?t.on("change",function(){var t=p("#"+this.id),e=this.getContent();t.val(e),t.html(e)}):t.onChange.add(function(t,e){s(t.id+" : Editor contents was modified. Contents: "+e.content),e=p("#"+t.id),t=t.getContent(),e.val(t),e.html(t)})}}),i=p.extend({},i,{id:t}),tinyMCEPreInit.mceInit[t]=e,tinyMCEPreInit.qtInit[t]=i,QTags.instances[i.id]=i,quicktags(i),QTags._buttonsInit(),window.tinymce.dom.Event.domLoaded=!0,tinyMCE.init(e),p(this).find(".wp-editor-wrap").first().on("click.wp-editor",function(){this.id&&(window.wpActiveEditor=this.id.slice(3,-5))})},r=function(t){t.each(function(t){if(p(this).find("textarea.wp-editor-area").length<=0)return!0;var e=p(this).find(".wp-editor-wrap");if(e.length<=0)return!0;var i=p().getAdminPageFrameworkInputOptions(e.attr("data-id")),n=p(this).find("textarea.wp-editor-area").first().show().removeAttr("aria-hidden"),r=p(this).find(".wp-editor-container").first().clone().empty(),a=p(this).find(".wp-editor-tools").first().clone();e.empty().prepend(r.prepend(n.show())).prepend(a),c(n.attr("id"),i.TinyMCE,i.QuickTags),p(this).find("a.wp-switch-editor").trigger("click")})},p().registerAdminPageFrameworkCallbacks({repeated_field:function(t,e){var i,n,r,a,d;o(0,e.field_type)?t.find("textarea.wp-editor-area").length<=0?s("not found .wp-editor-area"):(i=t.find(".wp-editor-wrap")).length<=0?s("not found .wp-editor-wrap"):(s("repeat passed"),n=p().getAdminPageFrameworkInputOptions(i.attr("data-id")),a=(r=t.closest(".admin-page-framework-field")).find("textarea.wp-editor-area").first().clone().show().removeAttr("aria-hidden"),d=r.find(".wp-editor-container").first().clone().empty(),t=r.find(".wp-editor-tools").first().clone(),a.val(""),a.empty(),i.empty().prepend(d.prepend(a.show())).prepend(t),c(a.attr("id"),n.TinyMCE,n.QuickTags),t.find("a,div,button").incrementAttributes(["id","data-wp-editor-id","data-editor"],e.incremented_from,e.id),r.find(".wp-editor-wrap a").incrementAttribute("data-editor",e.incremented_from,e.id),r.find(".wp-editor-wrap,.wp-editor-tools,.wp-editor-container").incrementAttribute("id",e.incremented_from,e.id)):s("the editor is not ready",e)},stopped_sorting_fields:function(e,t,i,n){o(0,t)&&setTimeout(function(){var t=e.children(".admin-page-framework-field");r(t)},100)},stopped_sorting_sections:function(e){setTimeout(function(){var t=p(e).find(".admin-page-framework-field");r(t)},100)},saved_widget:function(t){var r;"object"==typeof tinyMCEPreInit&&p(t).find(".admin-page-framework-field").each(function(t){if(p(this).find("textarea.wp-editor-area").length<=0)return!0;var e=p(this).find(".wp-editor-wrap");if(e.length<=0)return!0;var i=p(this).find("textarea.wp-editor-area").first(),n=i.attr("id").replace(/(widget-.+-)([0-9]+)(-)/i,"$1__i__$3");if(r=void 0===tinyMCEPreInit.mceInit[n]?r:n,void 0===tinyMCEPreInit.mceInit[r])return!0;c(i.attr("id"),tinyMCEPreInit.mceInit[r],tinyMCEPreInit.qtInit[r]),p().storeAdminPageFrameworkInputOptions(e.attr("data-id"),{TinyMCE:tinyMCEPreInit.mceInit[r],QuickTags:tinyMCEPreInit.qtInit[r]})})}},i.fieldTypeSlugs),p(".admin-page-framework-textarea-data-input").each(function(){var t=p(this).data("tinymce-textarea");p("#wp-"+t+"-wrap").attr("data-id",t),"object"==typeof tinyMCEPreInit&&p().storeAdminPageFrameworkInputOptions(t,{TinyMCE:tinyMCEPreInit.mceInit[t],QuickTags:tinyMCEPreInit.qtInit[t]})})):s("Textarea script data is not loaded.")})}(jQuery);